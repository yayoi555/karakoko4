<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚«ãƒ©ã‚³ã‚³ãƒŠãƒ“ï¼ˆè©¦é¨“ç‰ˆï¼‰ - ã‘ã‚“ã“ã†ãƒã‚§ãƒƒã‚¯</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <link rel="stylesheet" href="css/student.css?v=20250109">
</head>
<body class="bg-gradient-to-br from-blue-100 via-green-50 to-yellow-100 font-inter min-h-screen">
    
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="bg-white shadow-lg border-b-4 border-blue-400">
        <div class="max-w-4xl mx-auto px-4 py-6">
            <div class="flex items-center justify-center">
                <div class="text-center">
                    <div class="flex items-center justify-center mb-2">
                        <i class="fas fa-heart text-red-500 text-4xl mr-3 animate-pulse"></i>
                        <h1 class="text-3xl font-bold text-gray-800">ã‘ã‚“ã“ã†ãƒã‚§ãƒƒã‚¯</h1>
                        <i class="fas fa-smile text-yellow-500 text-4xl ml-3 animate-bounce"></i>
                    </div>
                    <p class="text-lg text-gray-600">ã˜ã¶ã‚“ã®ã‹ã‚‰ã ã®ã‚ˆã†ã™ã‚’ ãŠã—ãˆã¦ã­</p>
                </div>
            </div>
        </div>
    </header>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <main class="max-w-4xl mx-auto px-4 py-8">
        
        <!-- ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ -->
        <section id="loginSection" class="text-center">
            <div class="bg-white rounded-3xl shadow-xl p-8 mb-8 border-4 border-blue-200">
                <div class="mb-6">
                    <i class="fas fa-user-circle text-blue-500 text-6xl mb-4"></i>
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">ã ã‚Œã§ã™ã‹ï¼Ÿ</h2>
                    <p class="text-gray-600">ã˜ã¶ã‚“ã®ãªã¾ãˆã‚’ ãˆã‚‰ã‚“ã§ã­</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 max-w-3xl mx-auto">
                    <div>
                        <label class="block text-lg font-medium text-gray-700 mb-3">ãŒãã­ã‚“</label>
                        <select id="gradeSelect" class="w-full px-4 py-3 text-lg border-2 border-gray-300 rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-300 focus:border-blue-500">
                            <option value="">ãˆã‚‰ã‚“ã§ã­</option>
                            <option value="1">1ã­ã‚“ã›ã„</option>
                            <option value="2">2ã­ã‚“ã›ã„</option>
                            <option value="3">3ã­ã‚“ã›ã„</option>
                            <option value="4">4ã­ã‚“ã›ã„</option>
                            <option value="5">5ã­ã‚“ã›ã„</option>
                            <option value="6">6ã­ã‚“ã›ã„</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-lg font-medium text-gray-700 mb-3">ãã¿</label>
                        <select id="classSelect" class="w-full px-4 py-3 text-lg border-2 border-gray-300 rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-300 focus:border-blue-500" disabled>
                            <option value="">ã•ãã« ãŒãã­ã‚“ã‚’ ãˆã‚‰ã‚“ã§ã­</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-lg font-medium text-gray-700 mb-3">ãªã¾ãˆ</label>
                        <select id="studentSelect" class="w-full px-4 py-3 text-lg border-2 border-gray-300 rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-300 focus:border-blue-500" disabled>
                            <option value="">ã•ãã« ãŒãã­ã‚“ã¨ ãã¿ã‚’ ãˆã‚‰ã‚“ã§ã­</option>
                        </select>
                    </div>
                </div>

                <button id="loginBtn" class="mt-8 px-8 py-4 bg-blue-500 text-white text-xl font-bold rounded-2xl hover:bg-blue-600 focus:outline-none focus:ring-4 focus:ring-blue-300 transform hover:scale-105 transition-all disabled:bg-gray-300 disabled:transform-none" disabled>
                    <i class="fas fa-arrow-right mr-2"></i>ã¯ã˜ã‚ã‚‹
                </button>
            </div>
        </section>

        <!-- å¥åº·ãƒã‚§ãƒƒã‚¯ç”»é¢ -->
        <section id="healthCheckSection" class="hidden">
            <div class="bg-white rounded-3xl shadow-xl p-8 border-4 border-green-200">
                
                <!-- é€²æ—è¡¨ç¤º -->
                <div class="mb-8">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-2xl font-bold text-gray-800">
                            <span id="studentName"></span>ã•ã‚“ã® ã‘ã‚“ã“ã†ãƒã‚§ãƒƒã‚¯
                        </h2>
                        <button id="logoutBtn" class="px-4 py-2 bg-gray-500 text-white rounded-xl hover:bg-gray-600">
                            <i class="fas fa-sign-out-alt mr-1"></i>ã‚‚ã©ã‚‹
                        </button>
                    </div>
                    <div class="bg-gray-200 rounded-full h-4">
                        <div id="progressBar" class="bg-green-500 h-4 rounded-full transition-all duration-500" style="width: 0%"></div>
                    </div>
                    <p class="text-center mt-2 text-gray-600">
                        <span id="currentStep">1</span> / <span id="totalSteps">5</span>
                    </p>
                </div>

                <form id="studentHealthForm">
                    
                    <!-- ã‚¹ãƒ†ãƒƒãƒ—1: ã‹ã‚‰ã ã®ã¡ã‚‡ã†ã— -->
                    <div id="step1" class="step-content">
                        <div class="text-center mb-8">
                            <i class="fas fa-thermometer-half text-red-500 text-6xl mb-4"></i>
                            <h3 class="text-3xl font-bold text-gray-800 mb-4">ã‹ã‚‰ã ã® ã¡ã‚‡ã†ã—ã¯ï¼Ÿ</h3>
                            <p class="text-gray-600">ã‚ã¦ã¯ã¾ã‚‹ã‚‚ã®ã‚’ ãˆã‚‰ã‚“ã§ã­ï¼ˆã„ãã¤ã§ã‚‚OKï¼‰</p>
                        </div>

                        <div class="grid grid-cols-2 md:grid-cols-3 gap-4 max-w-4xl mx-auto">
                            <label class="symptom-option cursor-pointer">
                                <input type="checkbox" name="symptoms" value="ã’ã‚“ã" class="hidden">
                                <div class="p-4 border-3 border-gray-300 rounded-2xl hover:border-green-400 hover:bg-green-50 transition-all text-center">
                                    <div class="text-4xl mb-2">ğŸ˜Š</div>
                                    <div class="text-lg font-medium">ã’ã‚“ãã§ã™</div>
                                </div>
                            </label>
                            <label class="symptom-option cursor-pointer">
                                <input type="checkbox" name="symptoms" value="ç™ºç†±" class="hidden">
                                <div class="p-4 border-3 border-gray-300 rounded-2xl hover:border-red-400 hover:bg-red-50 transition-all text-center">
                                    <div class="text-4xl mb-2">ğŸ¤’</div>
                                    <div class="text-lg font-medium">ã­ã¤ãŒã‚ã‚‹</div>
                                </div>
                            </label>
                            <label class="symptom-option cursor-pointer">
                                <input type="checkbox" name="symptoms" value="å’³" class="hidden">
                                <div class="p-4 border-3 border-gray-300 rounded-2xl hover:border-orange-400 hover:bg-orange-50 transition-all text-center">
                                    <div class="text-4xl mb-2">ğŸ˜·</div>
                                    <div class="text-lg font-medium">ã›ããŒã§ã‚‹</div>
                                </div>
                            </label>
                            <label class="symptom-option cursor-pointer">
                                <input type="checkbox" name="symptoms" value="ã®ã©ã®ç—›ã¿" class="hidden">
                                <div class="p-4 border-3 border-gray-300 rounded-2xl hover:border-yellow-400 hover:bg-yellow-50 transition-all text-center">
                                    <div class="text-4xl mb-2">ğŸ¤§</div>
                                    <div class="text-lg font-medium">ã®ã©ãŒã„ãŸã„</div>
                                </div>
                            </label>
                            <label class="symptom-option cursor-pointer">
                                <input type="checkbox" name="symptoms" value="é ­ç—›" class="hidden">
                                <div class="p-4 border-3 border-gray-300 rounded-2xl hover:border-purple-400 hover:bg-purple-50 transition-all text-center">
                                    <div class="text-4xl mb-2">ğŸ¤•</div>
                                    <div class="text-lg font-medium">ã‚ãŸã¾ãŒã„ãŸã„</div>
                                </div>
                            </label>
                            <label class="symptom-option cursor-pointer">
                                <input type="checkbox" name="symptoms" value="è…¹ç—›" class="hidden">
                                <div class="p-4 border-3 border-gray-300 rounded-2xl hover:border-green-400 hover:bg-green-50 transition-all text-center">
                                    <div class="text-4xl mb-2">ğŸ¤¢</div>
                                    <div class="text-lg font-medium">ãŠãªã‹ãŒã„ãŸã„</div>
                                </div>
                            </label>
                            <label class="symptom-option cursor-pointer">
                                <input type="checkbox" name="symptoms" value="ã ã‚‹ã•" class="hidden">
                                <div class="p-4 border-3 border-gray-300 rounded-2xl hover:border-blue-400 hover:bg-blue-50 transition-all text-center">
                                    <div class="text-4xl mb-2">ğŸ˜ª</div>
                                    <div class="text-lg font-medium">ã ã‚‹ã„</div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- ã‚¹ãƒ†ãƒƒãƒ—2: ã¤ã‹ã‚Œãã‚ã„ -->
                    <div id="step2" class="step-content hidden">
                        <div class="text-center mb-8">
                            <i class="fas fa-battery-half text-green-500 text-6xl mb-4"></i>
                            <h3 class="text-3xl font-bold text-gray-800 mb-4">ã¤ã‹ã‚Œãã‚ã„ã¯ï¼Ÿ</h3>
                            <p class="text-gray-600">â˜…ã‚’ã‚¿ãƒƒãƒã—ã¦ ãŠã—ãˆã¦ã­</p>
                        </div>

                        <div class="max-w-md mx-auto">
                            <div class="flex justify-center items-center space-x-2 mb-6">
                                <button type="button" class="stress-star text-6xl text-gray-300 hover:text-yellow-400 transition-all" data-level="1">â­</button>
                                <button type="button" class="stress-star text-6xl text-gray-300 hover:text-yellow-400 transition-all" data-level="2">â­</button>
                                <button type="button" class="stress-star text-6xl text-gray-300 hover:text-yellow-400 transition-all" data-level="3">â­</button>
                                <button type="button" class="stress-star text-6xl text-gray-300 hover:text-yellow-400 transition-all" data-level="4">â­</button>
                                <button type="button" class="stress-star text-6xl text-gray-300 hover:text-yellow-400 transition-all" data-level="5">â­</button>
                            </div>
                            <div class="text-center">
                                <div class="flex justify-between text-lg font-medium text-gray-600">
                                    <span>ã’ã‚“ã</span>
                                    <span>ã¨ã¦ã‚‚ ã¤ã‹ã‚ŒãŸ</span>
                                </div>
                                <div id="stressMessage" class="mt-4 text-xl font-bold text-blue-600">â˜…ã‚’ ãˆã‚‰ã‚“ã§ã­</div>
                            </div>
                        </div>
                    </div>

                    <!-- ã‚¹ãƒ†ãƒƒãƒ—3: ãã¶ã‚“ -->
                    <div id="step3" class="step-content hidden">
                        <div class="text-center mb-8">
                            <i class="fas fa-smile-beam text-yellow-500 text-6xl mb-4"></i>
                            <h3 class="text-3xl font-bold text-gray-800 mb-4">ãã‚‡ã†ã® ãã¶ã‚“ã¯ï¼Ÿ</h3>
                            <p class="text-gray-600">ã„ã¡ã°ã‚“ ã¡ã‹ã„ã‚‚ã®ã‚’ ãˆã‚‰ã‚“ã§ã­</p>
                        </div>

                        <div class="grid grid-cols-2 md:grid-cols-3 gap-4 max-w-3xl mx-auto">
                            <button type="button" class="mood-btn p-6 border-3 border-gray-300 rounded-2xl hover:border-yellow-400 hover:bg-yellow-50 transition-all" data-mood="å…ƒæ°—">
                                <div class="text-4xl mb-2">ğŸ˜Š</div>
                                <div class="text-lg font-medium">ã’ã‚“ã</div>
                            </button>
                            <button type="button" class="mood-btn p-6 border-3 border-gray-300 rounded-2xl hover:border-blue-400 hover:bg-blue-50 transition-all" data-mood="ãµã¤ã†">
                                <div class="text-4xl mb-2">ğŸ˜</div>
                                <div class="text-lg font-medium">ãµã¤ã†</div>
                            </button>
                            <button type="button" class="mood-btn p-6 border-3 border-gray-300 rounded-2xl hover:border-orange-400 hover:bg-orange-50 transition-all" data-mood="ä¸å®‰">
                                <div class="text-4xl mb-2">ğŸ˜Ÿ</div>
                                <div class="text-lg font-medium">ã—ã‚“ã±ã„</div>
                            </button>
                            <button type="button" class="mood-btn p-6 border-3 border-gray-300 rounded-2xl hover:border-red-400 hover:bg-red-50 transition-all" data-mood="ã‚¤ãƒ©ã‚¤ãƒ©">
                                <div class="text-4xl mb-2">ğŸ˜ </div>
                                <div class="text-lg font-medium">ã„ã‚‰ã„ã‚‰</div>
                            </button>
                            <button type="button" class="mood-btn p-6 border-3 border-gray-300 rounded-2xl hover:border-purple-400 hover:bg-purple-50 transition-all" data-mood="çœ ã„">
                                <div class="text-4xl mb-2">ğŸ˜´</div>
                                <div class="text-lg font-medium">ã­ã‚€ã„</div>
                            </button>
                            <button type="button" class="mood-btn p-6 border-3 border-gray-300 rounded-2xl hover:border-indigo-400 hover:bg-indigo-50 transition-all" data-mood="æ‚²ã—ã„">
                                <div class="text-4xl mb-2">ğŸ˜¢</div>
                                <div class="text-lg font-medium">ã‹ãªã—ã„</div>
                            </button>
                        </div>
                    </div>

                    <!-- ã‚¹ãƒ†ãƒƒãƒ—4: ã›ã‚“ã›ã„ã« ãã†ã ã‚“ -->
                    <div id="step4" class="step-content hidden">
                        <div class="text-center mb-8">
                            <i class="fas fa-comment-heart text-pink-500 text-6xl mb-4"></i>
                            <h3 class="text-3xl font-bold text-gray-800 mb-4">ã›ã‚“ã›ã„ã« ãã†ã ã‚“ã—ãŸã„ã“ã¨ã¯ ã‚ã‚Šã¾ã™ã‹ï¼Ÿ</h3>
                            <p class="text-gray-600">ã²ã¨ã‚Šã§ ãªã‚„ã¾ãªã„ã§ ã›ã‚“ã›ã„ã« ã¯ãªã—ã¦ã­</p>
                        </div>

                        <div class="max-w-2xl mx-auto space-y-6">
                            <!-- ç›¸è«‡ãŒã‚ã‚‹ã‹ã©ã†ã‹ã®é¸æŠ -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <button type="button" class="consultation-choice p-6 border-3 border-gray-300 rounded-2xl hover:border-green-400 hover:bg-green-50 transition-all text-center" data-choice="none">
                                    <div class="text-4xl mb-2">ğŸ˜Š</div>
                                    <div class="text-lg font-medium">ãã†ã ã‚“ã¯ ã‚ã‚Šã¾ã›ã‚“</div>
                                </button>
                                
                                <button type="button" class="consultation-choice p-6 border-3 border-gray-300 rounded-2xl hover:border-pink-400 hover:bg-pink-50 transition-all text-center" data-choice="have">
                                    <div class="text-4xl mb-2">ğŸ™‹</div>
                                    <div class="text-lg font-medium">ãã†ã ã‚“ã—ãŸã„ã§ã™</div>
                                </button>
                            </div>

                            <!-- ç›¸è«‡å†…å®¹å…¥åŠ›ã‚¨ãƒªã‚¢ï¼ˆæœ€åˆã¯éè¡¨ç¤ºï¼‰ -->
                            <div id="consultationArea" class="hidden">
                                <div class="bg-white rounded-2xl p-6 border-3 border-pink-200">
                                    <h4 class="text-xl font-bold text-gray-800 mb-4 text-center">ã©ã‚“ãªã“ã¨ã‚’ ãã†ã ã‚“ã—ãŸã„ã§ã™ã‹ï¼Ÿ</h4>
                                    
                                    <!-- ç›¸è«‡å†…å®¹ã®é¸æŠè‚¢ -->
                                    <div class="grid grid-cols-2 md:grid-cols-3 gap-3 mb-4">
                                        <label class="consultation-option cursor-pointer">
                                            <input type="checkbox" name="consultation_topics" value="ãŠã¨ã‚‚ã ã¡ã®ã“ã¨" class="hidden">
                                            <div class="p-3 border-2 border-gray-300 rounded-xl hover:border-pink-400 hover:bg-pink-50 transition-all text-center">
                                                <div class="text-3xl mb-1">ğŸ‘«</div>
                                                <div class="text-sm font-medium">ãŠã¨ã‚‚ã ã¡ã®ã“ã¨</div>
                                            </div>
                                        </label>
                                        <label class="consultation-option cursor-pointer">
                                            <input type="checkbox" name="consultation_topics" value="ã¹ã‚“ãã‚‡ã†ã®ã“ã¨" class="hidden">
                                            <div class="p-3 border-2 border-gray-300 rounded-xl hover:border-blue-400 hover:bg-blue-50 transition-all text-center">
                                                <div class="text-3xl mb-1">ğŸ“š</div>
                                                <div class="text-sm font-medium">ã¹ã‚“ãã‚‡ã†ã®ã“ã¨</div>
                                            </div>
                                        </label>
                                        <label class="consultation-option cursor-pointer">
                                            <input type="checkbox" name="consultation_topics" value="ãŠã†ã¡ã®ã“ã¨" class="hidden">
                                            <div class="p-3 border-2 border-gray-300 rounded-xl hover:border-green-400 hover:bg-green-50 transition-all text-center">
                                                <div class="text-3xl mb-1">ğŸ </div>
                                                <div class="text-sm font-medium">ãŠã†ã¡ã®ã“ã¨</div>
                                            </div>
                                        </label>
                                        <label class="consultation-option cursor-pointer">
                                            <input type="checkbox" name="consultation_topics" value="ã‹ã‚‰ã ã®ã“ã¨" class="hidden">
                                            <div class="p-3 border-2 border-gray-300 rounded-xl hover:border-red-400 hover:bg-red-50 transition-all text-center">
                                                <div class="text-3xl mb-1">ğŸ’Š</div>
                                                <div class="text-sm font-medium">ã‹ã‚‰ã ã®ã“ã¨</div>
                                            </div>
                                        </label>
                                        <label class="consultation-option cursor-pointer">
                                            <input type="checkbox" name="consultation_topics" value="ãã‚‚ã¡ã®ã“ã¨" class="hidden">
                                            <div class="p-3 border-2 border-gray-300 rounded-xl hover:border-purple-400 hover:bg-purple-50 transition-all text-center">
                                                <div class="text-3xl mb-1">ğŸ’­</div>
                                                <div class="text-sm font-medium">ãã‚‚ã¡ã®ã“ã¨</div>
                                            </div>
                                        </label>
                                        <label class="consultation-option cursor-pointer">
                                            <input type="checkbox" name="consultation_topics" value="ãã®ã»ã‹" class="hidden">
                                            <div class="p-3 border-2 border-gray-300 rounded-xl hover:border-orange-400 hover:bg-orange-50 transition-all text-center">
                                                <div class="text-3xl mb-1">âœ¨</div>
                                                <div class="text-sm font-medium">ãã®ã»ã‹</div>
                                            </div>
                                        </label>
                                    </div>
                                    
                                    <!-- è‡ªç”±è¨˜è¿°æ¬„ -->
                                    <div class="mt-4">
                                        <label class="block text-sm font-medium text-gray-700 mb-2 text-center">ãã‚ã—ã ãŠã—ãˆã¦ã­ï¼ˆã‹ã‹ãªãã¦ã‚‚ OKï¼‰</label>
                                        <textarea 
                                            id="consultationContent" 
                                            rows="4" 
                                            class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:ring-4 focus:ring-pink-300 focus:border-pink-500 text-lg resize-none"
                                            placeholder="ã‚‚ã£ã¨ ãã‚ã—ã ã¯ãªã—ãŸã„ã“ã¨ãŒ ã‚ã£ãŸã‚‰ ã“ã“ã« ã‹ã„ã¦ã­"
                                        ></textarea>
                                    </div>
                                    
                                    <div class="mt-4">
                                        <h5 class="text-lg font-medium text-gray-800 mb-3 text-center">ã ã‚Œã›ã‚“ã›ã„ã« ãã†ã ã‚“ã—ãŸã„ã§ã™ã‹ï¼Ÿ</h5>
                                        <select id="teacherSelect" class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:ring-4 focus:ring-pink-300 focus:border-pink-500 text-lg">
                                            <option value="">ã›ã‚“ã›ã„ã‚’ ãˆã‚‰ã‚“ã§ã­</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ã‚¹ãƒ†ãƒƒãƒ—5: ã‹ãã«ã‚“ -->
                    <div id="step5" class="step-content hidden">
                        <div class="text-center mb-8">
                            <i class="fas fa-check-circle text-green-500 text-6xl mb-4"></i>
                            <h3 class="text-3xl font-bold text-gray-800 mb-4">ã‹ãã«ã‚“ã—ã¦ã­</h3>
                            <p class="text-gray-600">ã ã„ã˜ã‚‡ã†ã¶ã§ã™ã‹ï¼Ÿ</p>
                        </div>

                        <div class="bg-gray-50 rounded-2xl p-6 max-w-2xl mx-auto">
                            <div class="space-y-4">
                                <div class="flex items-center justify-between p-3 bg-white rounded-xl">
                                    <span class="font-medium">ãã¶ã‚“:</span>
                                    <span id="confirmMood" class="text-lg">-</span>
                                </div>
                                <div class="flex items-center justify-between p-3 bg-white rounded-xl">
                                    <span class="font-medium">ã¤ã‹ã‚Œãã‚ã„:</span>
                                    <span id="confirmStress" class="text-lg">-</span>
                                </div>
                                <div class="p-3 bg-white rounded-xl">
                                    <div class="font-medium mb-2">ã‹ã‚‰ã ã®ã¡ã‚‡ã†ã—:</div>
                                    <div id="confirmSymptoms" class="text-lg">-</div>
                                </div>
                                <div class="p-3 bg-white rounded-xl">
                                    <div class="font-medium mb-2">ã›ã‚“ã›ã„ã¸ã® ãã†ã ã‚“:</div>
                                    <div id="confirmConsultation" class="text-lg text-gray-600 italic">-</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ -->
                    <div class="flex justify-between mt-12">
                        <button type="button" id="prevBtn" class="px-6 py-3 bg-gray-500 text-white text-lg font-bold rounded-xl hover:bg-gray-600 focus:outline-none focus:ring-4 focus:ring-gray-300 disabled:bg-gray-300" disabled>
                            <i class="fas fa-arrow-left mr-2"></i>ã¾ãˆã¸
                        </button>
                        
                        <button type="button" id="nextBtn" class="px-6 py-3 bg-blue-500 text-white text-lg font-bold rounded-xl hover:bg-blue-600 focus:outline-none focus:ring-4 focus:ring-blue-300 disabled:bg-gray-300" disabled>
                            ã¤ãã¸<i class="fas fa-arrow-right ml-2"></i>
                        </button>
                        
                        <button type="submit" id="submitBtn" class="hidden px-6 py-3 bg-green-500 text-white text-lg font-bold rounded-xl hover:bg-green-600 focus:outline-none focus:ring-4 focus:ring-green-300">
                            <i class="fas fa-paper-plane mr-2"></i>ãŠãã‚‹
                        </button>
                    </div>

                </form>
            </div>
        </section>

        <!-- å®Œäº†ç”»é¢ -->
        <section id="completeSection" class="hidden text-center">
            <div class="bg-white rounded-3xl shadow-xl p-8 border-4 border-green-200">
                <div class="mb-6">
                    <i class="fas fa-heart text-pink-500 text-8xl mb-4 animate-pulse"></i>
                    <h2 class="text-3xl font-bold text-gray-800 mb-4">ãŠã—ãˆã¦ãã‚Œã¦ã€€ã‚ã‚ŠãŒã¨ã†</h2>
                    <p class="text-xl text-gray-600 mb-6">ã‘ã‚“ã“ã†ãƒã‚§ãƒƒã‚¯ãŒ ãŠã‚ã‚Šã¾ã—ãŸ</p>
                    <div class="text-6xl mb-4">ğŸ’</div>
                </div>
            </div>
        </section>

    </main>

    <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
    <footer class="text-center py-8 text-gray-500">
        <p>ã‘ã‚“ã“ã†ã« ãã‚’ã¤ã‘ã¦ ã™ã”ã—ã¦ã­ ğŸ’™</p>
    </footer>

    <!-- ãƒ‡ãƒ¼ã‚¿ç®¡ç† -->
    <script src="js/static-data-manager.js"></script>
    <script src="js/firebase-adapter.js"></script>
    <script src="js/supabase-adapter.js"></script>
    <script src="js/api-adapter.js"></script>
    <script>
        // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®è¨­å®šã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦é©åˆ‡ãªã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã‚’é¸æŠ
        (async function initializeAdapter() {
            // Supabaseè¨­å®šï¼ˆå…¨ç«¯æœ«ã§å…±é€šï¼‰
            const SUPABASE_CONFIG = {
                url: 'https://gcvaczijcdgzaoaxwhpz.supabase.co',
                key: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdjdmFjemlqY2RnemFvYXh3aHB6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQwODEyNTksImV4cCI6MjA3OTY1NzI1OX0.mu-ky-N0bUbRlkKvH9DUAJiUT2CXDvY4hPFJfjGwlKI'
            };
            
            // Supabaseãƒ¢ãƒ¼ãƒ‰ã‚’ãƒã‚§ãƒƒã‚¯
            let useSupabase = localStorage.getItem('use_supabase') === 'true';
            
            // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§Supabaseãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹åŒ–
            if (!useSupabase && !localStorage.getItem('use_firebase')) {
                console.log('ğŸ”§ Supabaseãƒ¢ãƒ¼ãƒ‰ã‚’è‡ªå‹•é©ç”¨ä¸­...');
                localStorage.setItem('use_supabase', 'true');
                useSupabase = true;
                console.log('âœ… Supabaseãƒ¢ãƒ¼ãƒ‰ã‚’è‡ªå‹•é©ç”¨ã—ã¾ã—ãŸ');
            }
            
            if (useSupabase) {
                try {
                    console.log('â˜ï¸ Supabaseãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•');
                    
                    // Supabaseã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã‚’åˆæœŸåŒ–
                    window.supabaseAdapter = new SupabaseAdapter(SUPABASE_CONFIG.url, SUPABASE_CONFIG.key);
                    
                    // fetché–¢æ•°ã‚’Supabaseç‰ˆã«ç½®ãæ›ãˆ
                    window.originalFetch = window.fetch;
                    window.fetch = function(url, options) {
                        if (url.startsWith('tables/')) {
                            return window.supabaseAdapter.fetch(url, options);
                        } else {
                            return window.originalFetch(url, options);
                        }
                    };
                    
                    console.log('âœ… SupabaseåˆæœŸåŒ–å®Œäº†');
                } catch (error) {
                    console.error('âŒ SupabaseåˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
                    console.warn('âš ï¸ Supabaseã«æ¥ç¶šã§ãã¾ã›ã‚“ã§ã—ãŸã€‚localStorageãƒ¢ãƒ¼ãƒ‰ã§å‹•ä½œã—ã¾ã™ã€‚');
                }
                return; // Supabaseãƒ¢ãƒ¼ãƒ‰ã®å ´åˆã¯ã“ã“ã§çµ‚äº†
            }
            
            // ä»¥ä¸‹ã€Firebaseã¾ãŸã¯localStorageãƒ¢ãƒ¼ãƒ‰ã®å‡¦ç†
            const DEFAULT_FIREBASE_CONFIG = {
                apiKey: "YOUR_API_KEY",
                authDomain: "YOUR_PROJECT.firebaseapp.com",
                projectId: "YOUR_PROJECT_ID",
                storageBucket: "YOUR_PROJECT.appspot.com",
                messagingSenderId: "YOUR_SENDER_ID",
                appId: "YOUR_APP_ID"
            };
            
            let useFirebase = localStorage.getItem('use_firebase') === 'true';
            let firebaseConfigStr = localStorage.getItem('firebase_config');
            
            if (useFirebase && firebaseConfigStr) {
                try {
                    console.log('ğŸ”¥ Firebaseãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•');
                    const firebaseConfig = JSON.parse(firebaseConfigStr);
                    
                    await window.firebaseAdapter.initialize(firebaseConfig);
                    
                    window.originalFetch = window.fetch;
                    window.fetch = function(url, options) {
                        if (url.startsWith('tables/')) {
                            return window.firebaseAdapter.fetch(url, options);
                        } else {
                            return window.originalFetch(url, options);
                        }
                    };
                    
                    console.log('âœ… FirebaseåˆæœŸåŒ–å®Œäº†');
                } catch (error) {
                    console.error('âŒ FirebaseåˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
                    // å…ç«¥ç”¨ç”»é¢ã§ã¯ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿è¡¨ç¤ºï¼ˆè‡ªå‹•çš„ã«localStorageã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
                    console.warn('âš ï¸ Firebaseã«æ¥ç¶šã§ãã¾ã›ã‚“ã§ã—ãŸã€‚localStorageãƒ¢ãƒ¼ãƒ‰ã§å‹•ä½œã—ã¾ã™ã€‚');
                }
            } else {
                console.log('ğŸ’¾ ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•');
                
                // StaticDataManagerã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆï¼ˆAPIAdapterã‚ˆã‚Šå…ˆã«ï¼ï¼‰
                if (typeof StaticDataManager !== 'undefined') {
                    window.staticDataManager = new StaticDataManager();
                    console.log('âœ… StaticDataManageråˆæœŸåŒ–å®Œäº†');
                } else {
                    console.error('âŒ StaticDataManagerãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“');
                }
                
                // localStorageãƒ¢ãƒ¼ãƒ‰ã®å ´åˆã€APIAdapterã§fetchã‚’ã‚¤ãƒ³ã‚¿ãƒ¼ã‚»ãƒ—ãƒˆ
                if (typeof APIAdapter !== 'undefined') {
                    window.apiAdapter = new APIAdapter();
                    
                    // APIAdapterã®dataManagerã‚’ç¢ºå®Ÿã«è¨­å®š
                    if (window.staticDataManager) {
                        window.apiAdapter.dataManager = window.staticDataManager;
                        console.log('âœ… APIAdapter.dataManagerè¨­å®šå®Œäº†');
                    }
                    
                    window.originalFetch = window.fetch;
                    window.fetch = function(url, options) {
                        if (url.startsWith('tables/')) {
                            return window.apiAdapter.fetch(url, options);
                        } else {
                            return window.originalFetch(url, options);
                        }
                    };
                    console.log('âœ… APIAdapteråˆæœŸåŒ–å®Œäº†ï¼ˆlocalStorageãƒ¢ãƒ¼ãƒ‰ï¼‰');
                } else {
                    console.error('âŒ APIAdapterãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“');
                }
            }
        })();
    </script>
    <!-- æ—¢å­˜ã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
    <script src="js/student.js?v=20250128fixed"></script>
</body>
</html>
