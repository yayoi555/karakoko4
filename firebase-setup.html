<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebaseãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®š - ã‚«ãƒ©ã‚³ã‚³ãƒŠãƒ“</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <script src="js/firebase-adapter.js"></script>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <i class="fas fa-database text-4xl text-blue-600 mr-4"></i>
                    <div>
                        <h1 class="text-3xl font-bold text-gray-800">Firebaseãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®š</h1>
                        <p class="text-gray-600 mt-1">150-200å°ã®PCåŒæ™‚ã‚¢ã‚¯ã‚»ã‚¹ã‚’å®Ÿç¾</p>
                    </div>
                </div>
                <a href="teacher.html" class="bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition">
                    <i class="fas fa-arrow-left mr-2"></i>æ•™å“¡ç”»é¢ã«æˆ»ã‚‹
                </a>
            </div>
        </div>

        <!-- é€²æ—ãƒãƒ¼ -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
                <div class="flex-1 mx-2 text-center step-indicator active" data-step="1">
                    <div class="step-circle">1</div>
                    <p class="text-sm mt-2">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ</p>
                </div>
                <div class="flex-1 mx-2 text-center step-indicator" data-step="2">
                    <div class="step-circle">2</div>
                    <p class="text-sm mt-2">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ</p>
                </div>
                <div class="flex-1 mx-2 text-center step-indicator" data-step="3">
                    <div class="step-circle">3</div>
                    <p class="text-sm mt-2">Firestoreè¨­å®š</p>
                </div>
                <div class="flex-1 mx-2 text-center step-indicator" data-step="4">
                    <div class="step-circle">4</div>
                    <p class="text-sm mt-2">æ¥ç¶šæƒ…å ±å–å¾—</p>
                </div>
                <div class="flex-1 mx-2 text-center step-indicator" data-step="5">
                    <div class="step-circle">5</div>
                    <p class="text-sm mt-2">ãƒ‡ãƒ¼ã‚¿ç§»è¡Œ</p>
                </div>
            </div>
        </div>

        <!-- Step 1: Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ -->
        <div class="step-content" id="step1">
            <div class="bg-white rounded-lg shadow-lg p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-user-plus text-blue-600 mr-3"></i>
                    Step 1: Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ
                </h2>
                
                <div class="space-y-4">
                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4">
                        <p class="font-semibold text-blue-800">âœ“ æ—¢ã«Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãŠæŒã¡ã®å ´åˆ</p>
                        <p class="text-blue-700 mt-1">ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã¯ã‚¹ã‚­ãƒƒãƒ—ã§ãã¾ã™ã€‚æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã«é€²ã‚“ã§ãã ã•ã„ã€‚</p>
                    </div>

                    <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4">
                        <p class="font-semibold text-yellow-800">âš ï¸ æ–°è¦ä½œæˆãŒå¿…è¦ãªå ´åˆ</p>
                        <ol class="list-decimal ml-6 mt-2 space-y-2 text-gray-700">
                            <li><a href="https://accounts.google.com/signup" target="_blank" class="text-blue-600 hover:underline">Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆãƒšãƒ¼ã‚¸</a> ã«ã‚¢ã‚¯ã‚»ã‚¹</li>
                            <li>å¿…è¦äº‹é …ã‚’å…¥åŠ›ã—ã¦ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ</li>
                            <li>ãƒ¡ãƒ¼ãƒ«èªè¨¼ã‚’å®Œäº†</li>
                        </ol>
                    </div>

                    <div class="bg-green-50 border-l-4 border-green-500 p-4">
                        <p class="font-semibold text-green-800">ğŸ’¡ æ¨å¥¨</p>
                        <p class="text-green-700 mt-1">å­¦æ ¡å°‚ç”¨ã®Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆä¾‹: school-health@example.comï¼‰ã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚</p>
                    </div>
                </div>

                <div class="mt-6 flex justify-end">
                    <button onclick="nextStep(2)" class="bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 transition">
                        æ¬¡ã¸é€²ã‚€ <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 2: Firebaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ -->
        <div class="step-content hidden" id="step2">
            <div class="bg-white rounded-lg shadow-lg p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-rocket text-blue-600 mr-3"></i>
                    Step 2: Firebaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
                </h2>
                
                <div class="space-y-6">
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="font-bold text-lg mb-4 flex items-center">
                            <span class="bg-blue-600 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3">1</span>
                            Firebase Consoleã«ã‚¢ã‚¯ã‚»ã‚¹
                        </h3>
                        <p class="ml-11 mb-3">ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‹ã‚‰Firebase Consoleã‚’é–‹ãã¾ã™ï¼š</p>
                        <a href="https://console.firebase.google.com/" target="_blank" 
                           class="ml-11 inline-block bg-orange-500 text-white px-6 py-3 rounded-lg hover:bg-orange-600 transition">
                            <i class="fas fa-external-link-alt mr-2"></i>Firebase Console ã‚’é–‹ã
                        </a>
                    </div>

                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="font-bold text-lg mb-4 flex items-center">
                            <span class="bg-blue-600 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3">2</span>
                            ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
                        </h3>
                        <ol class="ml-11 space-y-2 text-gray-700">
                            <li><strong>ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿½åŠ ã€</strong>ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                            <li><strong>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå</strong>ã‚’å…¥åŠ›ï¼ˆä¾‹: karakoko-naviï¼‰</li>
                            <li>Google Analyticsã®è¨­å®šï¼ˆ<span class="text-red-600">ã‚ªãƒ•ã‚’æ¨å¥¨</span>ï¼‰</li>
                            <li><strong>ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã€</strong>ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                            <li>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆå®Œäº†ã¾ã§æ•°ç§’å¾…æ©Ÿ</li>
                        </ol>
                    </div>

                    <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4">
                        <p class="font-semibold text-yellow-800">â±ï¸ æ‰€è¦æ™‚é–“</p>
                        <p class="text-yellow-700 mt-1">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆã«ã¯é€šå¸¸10-30ç§’ã‹ã‹ã‚Šã¾ã™ã€‚</p>
                    </div>
                </div>

                <div class="mt-6 flex justify-between">
                    <button onclick="prevStep(1)" class="bg-gray-500 text-white px-8 py-3 rounded-lg hover:bg-gray-600 transition">
                        <i class="fas fa-arrow-left mr-2"></i>å‰ã¸æˆ»ã‚‹
                    </button>
                    <button onclick="nextStep(3)" class="bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 transition">
                        æ¬¡ã¸é€²ã‚€ <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 3: Firestore Databaseè¨­å®š -->
        <div class="step-content hidden" id="step3">
            <div class="bg-white rounded-lg shadow-lg p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-database text-blue-600 mr-3"></i>
                    Step 3: Firestore Databaseè¨­å®š
                </h2>
                
                <div class="space-y-6">
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="font-bold text-lg mb-4 flex items-center">
                            <span class="bg-blue-600 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3">1</span>
                            Firestoreã‚’æœ‰åŠ¹åŒ–
                        </h3>
                        <ol class="ml-11 space-y-2 text-gray-700">
                            <li>å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®<strong>ã€Œæ§‹ç¯‰ã€</strong>ã‚»ã‚¯ã‚·ãƒ§ãƒ³å†…ã®<strong>ã€ŒFirestore Databaseã€</strong>ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                            <li><strong>ã€Œãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ä½œæˆã€</strong>ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                        </ol>
                    </div>

                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="font-bold text-lg mb-4 flex items-center">
                            <span class="bg-blue-600 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3">2</span>
                            ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ã®é¸æŠ
                        </h3>
                        <div class="ml-11">
                            <p class="mb-3"><strong class="text-red-600">é‡è¦:</strong> ä»¥ä¸‹ã®2ã¤ã®ãƒ¢ãƒ¼ãƒ‰ã‹ã‚‰é¸æŠã—ã¦ãã ã•ã„ï¼š</p>
                            
                            <div class="bg-yellow-50 border-2 border-yellow-400 p-4 rounded-lg mb-3">
                                <p class="font-bold text-yellow-800 mb-2">ğŸ”“ ãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰ã§é–‹å§‹ï¼ˆæ¨å¥¨ - ç°¡å˜è¨­å®šï¼‰</p>
                                <ul class="list-disc ml-6 text-sm text-gray-700 space-y-1">
                                    <li>30æ—¥é–“ã¯èª°ã§ã‚‚ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½</li>
                                    <li>ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒç°¡å˜</li>
                                    <li><strong>30æ—¥å¾Œã«è‡ªå‹•ã§ã‚¢ã‚¯ã‚»ã‚¹ä¸å¯</strong>ã«ãªã‚‹ãŸã‚ã€å¾Œã§æœ¬ç•ªãƒ«ãƒ¼ãƒ«ã«å¤‰æ›´å¿…è¦</li>
                                </ul>
                            </div>

                            <div class="bg-green-50 border-2 border-green-400 p-4 rounded-lg">
                                <p class="font-bold text-green-800 mb-2">ğŸ”’ æœ¬ç•ªãƒ¢ãƒ¼ãƒ‰ã§é–‹å§‹ï¼ˆã‚»ã‚­ãƒ¥ã‚¢ï¼‰</p>
                                <ul class="list-disc ml-6 text-sm text-gray-700 space-y-1">
                                    <li>åˆæœŸçŠ¶æ…‹ã§ã™ã¹ã¦ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒæ‹’å¦</li>
                                    <li>æ‰‹å‹•ã§ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šã™ã‚‹å¿…è¦ã‚ã‚Š</li>
                                    <li>é•·æœŸé‹ç”¨ã«é©ã—ã¦ã„ã‚‹</li>
                                </ul>
                            </div>

                            <div class="bg-blue-50 p-4 rounded-lg mt-4">
                                <p class="font-semibold text-blue-800 mb-2">ğŸ’¡ ã©ã¡ã‚‰ã‚’é¸ã¶ã¹ã?</p>
                                <p class="text-sm text-blue-700"><strong>åˆã‚ã¦ã®æ–¹: ãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰</strong>ã‚’é¸ã³ã€å¾Œã§Step 3-3ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚</p>
                            </div>
                        </div>
                    </div>

                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="font-bold text-lg mb-4 flex items-center">
                            <span class="bg-blue-600 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3">3</span>
                            ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ã®è¨­å®šï¼ˆæœ¬ç•ªé‹ç”¨æ™‚ï¼‰
                        </h3>
                        <div class="ml-11">
                            <p class="mb-3">å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®<strong>ã€Œãƒ«ãƒ¼ãƒ«ã€</strong>ã‚¿ãƒ–ã§ä»¥ä¸‹ã®ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šï¼š</p>
                            <div class="bg-gray-800 text-green-400 p-4 rounded-lg font-mono text-sm overflow-x-auto">
<pre>rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // ã™ã¹ã¦ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¸ã®èª­ã¿æ›¸ãã‚’è¨±å¯
    // âš ï¸ æ ¡å†…ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é™å®šã§ã®ä½¿ç”¨ã‚’æ¨å¥¨
    match /{document=**} {
      allow read, write: if true;
    }
    
    // ã‚ˆã‚Šå®‰å…¨ãªè¨­å®šä¾‹ï¼ˆç‰¹å®šã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã®ã¿è¨±å¯ï¼‰
    // match /students/{docId} {
    //   allow read, write: if true;
    // }
    // match /consultations/{docId} {
    //   allow read, write: if true;
    // }
    // match /surveys/{docId} {
    //   allow read, write: if true;
    // }
  }
}</pre>
                            </div>
                            <div class="bg-red-50 border-l-4 border-red-500 p-4 mt-4">
                                <p class="font-semibold text-red-800">âš ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ³¨æ„</p>
                                <ul class="list-disc ml-6 text-sm text-red-700 mt-2 space-y-1">
                                    <li>ä¸Šè¨˜ãƒ«ãƒ¼ãƒ«ã¯<strong>ã™ã¹ã¦ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯</strong>ã—ã¾ã™</li>
                                    <li><strong>æ ¡å†…ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é™å®š</strong>ã§ã®ä½¿ç”¨ã‚’å¼·ãæ¨å¥¨</li>
                                    <li>ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆå…¬é–‹ã™ã‚‹å ´åˆã¯èªè¨¼æ©Ÿèƒ½ã®å®Ÿè£…ãŒå¿…é ˆ</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="font-bold text-lg mb-4 flex items-center">
                            <span class="bg-blue-600 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3">4</span>
                            ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³é¸æŠ
                        </h3>
                        <p class="ml-11 mb-2">ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ³ã‚¿ãƒ¼ã®å ´æ‰€ã‚’é¸æŠã—ã¾ã™ï¼š</p>
                        <ul class="ml-11 list-disc space-y-1 text-gray-700">
                            <li><strong>asia-northeast1 (æ±äº¬)</strong> - æ¨å¥¨ï¼ˆæ—¥æœ¬ã§ã®ä½¿ç”¨ã«æœ€é©ï¼‰</li>
                            <li><strong>asia-northeast2 (å¤§é˜ª)</strong> - ä»£æ›¿é¸æŠè‚¢</li>
                        </ul>
                        <p class="ml-11 mt-2 text-sm text-gray-600">â€» ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯å¾Œã‹ã‚‰å¤‰æ›´ã§ãã¾ã›ã‚“</p>
                    </div>

                    <div class="bg-green-50 border-l-4 border-green-500 p-4">
                        <p class="font-semibold text-green-800">âœ… å®Œäº†</p>
                        <p class="text-green-700 mt-1"><strong>ã€Œæœ‰åŠ¹ã«ã™ã‚‹ã€</strong>ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€Firestoreã‚’æœ‰åŠ¹åŒ–ã—ã¦ãã ã•ã„ã€‚</p>
                    </div>
                </div>

                <div class="mt-6 flex justify-between">
                    <button onclick="prevStep(2)" class="bg-gray-500 text-white px-8 py-3 rounded-lg hover:bg-gray-600 transition">
                        <i class="fas fa-arrow-left mr-2"></i>å‰ã¸æˆ»ã‚‹
                    </button>
                    <button onclick="nextStep(4)" class="bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 transition">
                        æ¬¡ã¸é€²ã‚€ <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 4: æ¥ç¶šæƒ…å ±å–å¾— -->
        <div class="step-content hidden" id="step4">
            <div class="bg-white rounded-lg shadow-lg p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-key text-blue-600 mr-3"></i>
                    Step 4: Firebaseæ¥ç¶šæƒ…å ±ã®å–å¾—
                </h2>
                
                <div class="space-y-6">
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="font-bold text-lg mb-4 flex items-center">
                            <span class="bg-blue-600 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3">1</span>
                            Web ã‚¢ãƒ—ãƒªã‚’è¿½åŠ 
                        </h3>
                        <ol class="ml-11 space-y-2 text-gray-700">
                            <li>Firebase Consoleã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</li>
                            <li><strong>ã€Œ&lt;/&gt;ã€ã‚¢ã‚¤ã‚³ãƒ³</strong>ï¼ˆWebã‚¢ãƒ—ãƒªï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                            <li>ã‚¢ãƒ—ãƒªã®ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚’å…¥åŠ›ï¼ˆä¾‹: karakoko-webï¼‰</li>
                            <li><strong>ã€ŒFirebase Hostingã€ã¯è¨­å®šä¸è¦</strong>ï¼ˆãƒã‚§ãƒƒã‚¯ã‚’å¤–ã™ï¼‰</li>
                            <li><strong>ã€Œã‚¢ãƒ—ãƒªã‚’ç™»éŒ²ã€</strong>ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                        </ol>
                    </div>

                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="font-bold text-lg mb-4 flex items-center">
                            <span class="bg-blue-600 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3">2</span>
                            Firebase Config ã‚’ã‚³ãƒ”ãƒ¼
                        </h3>
                        <p class="ml-11 mb-3">ä»¥ä¸‹ã®ã‚ˆã†ãªè¨­å®šæƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š</p>
                        <div class="ml-11 bg-gray-800 text-green-400 p-4 rounded-lg font-mono text-sm overflow-x-auto mb-3">
<pre>const firebaseConfig = {
  apiKey: "AIza...",
  authDomain: "your-project.firebaseapp.com",
  projectId: "your-project-id",
  storageBucket: "your-project.appspot.com",
  messagingSenderId: "123456789",
  appId: "1:123:web:abc123"
};</pre>
                        </div>
                        <p class="ml-11 text-sm text-gray-600">ã“ã®æƒ…å ±ã‚’æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã§å…¥åŠ›ã—ã¾ã™ã€‚ãƒ¡ãƒ¢å¸³ãªã©ã«ä¸€æ™‚ä¿å­˜ã—ã¦ãŠã„ã¦ãã ã•ã„ã€‚</p>
                    </div>

                    <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4">
                        <p class="font-semibold text-yellow-800">ğŸ’¡ å¾Œã‹ã‚‰ç¢ºèªã™ã‚‹æ–¹æ³•</p>
                        <p class="text-yellow-700 mt-1">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š â†’ å…¨èˆ¬ â†’ ãƒã‚¤ã‚¢ãƒ—ãƒª â†’ SDK ã®è¨­å®šã¨æ§‹æˆ ã§å†ç¢ºèªã§ãã¾ã™ã€‚</p>
                    </div>

                    <div class="bg-blue-50 p-6 rounded-lg">
                        <h3 class="font-bold text-lg mb-4">ä¸‹è¨˜ã®ãƒ•ã‚©ãƒ¼ãƒ ã«æ¥ç¶šæƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</h3>
                        <form id="firebaseConfigForm" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">API Key *</label>
                                <input type="text" id="apiKey" required
                                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                                       placeholder="AIzaSy...">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Auth Domain *</label>
                                <input type="text" id="authDomain" required
                                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                                       placeholder="your-project.firebaseapp.com">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Project ID *</label>
                                <input type="text" id="projectId" required
                                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                                       placeholder="your-project-id">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Storage Bucket *</label>
                                <input type="text" id="storageBucket" required
                                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                                       placeholder="your-project.appspot.com">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Messaging Sender ID *</label>
                                <input type="text" id="messagingSenderId" required
                                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                                       placeholder="123456789">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">App ID *</label>
                                <input type="text" id="appId" required
                                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                                       placeholder="1:123:web:abc123">
                            </div>
                        </form>

                        <div class="mt-6 bg-white border-2 border-blue-500 rounded-lg p-4">
                            <button onclick="testConnection()" 
                                    class="w-full bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition">
                                <i class="fas fa-plug mr-2"></i>æ¥ç¶šãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
                            </button>
                            <div id="connectionResult" class="mt-4 hidden"></div>
                        </div>
                    </div>
                </div>

                <div class="mt-6 flex justify-between">
                    <button onclick="prevStep(3)" class="bg-gray-500 text-white px-8 py-3 rounded-lg hover:bg-gray-600 transition">
                        <i class="fas fa-arrow-left mr-2"></i>å‰ã¸æˆ»ã‚‹
                    </button>
                    <button id="step4NextBtn" onclick="nextStep(5)" disabled
                            class="bg-gray-400 text-white px-8 py-3 rounded-lg cursor-not-allowed">
                        æ¬¡ã¸é€²ã‚€ <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 5: ãƒ‡ãƒ¼ã‚¿ç§»è¡Œ -->
        <div class="step-content hidden" id="step5">
            <div class="bg-white rounded-lg shadow-lg p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-exchange-alt text-blue-600 mr-3"></i>
                    Step 5: ãƒ‡ãƒ¼ã‚¿ç§»è¡Œã¨å®Œäº†
                </h2>
                
                <div class="space-y-6">
                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4">
                        <p class="font-semibold text-blue-800">ğŸ“¦ ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿çŠ¶æ³</p>
                        <div id="currentDataInfo" class="mt-2 text-blue-700"></div>
                    </div>

                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="font-bold text-lg mb-4">ãƒ‡ãƒ¼ã‚¿ç§»è¡Œã‚ªãƒ—ã‚·ãƒ§ãƒ³</h3>
                        
                        <div class="space-y-4">
                            <div class="bg-white border-2 border-blue-300 rounded-lg p-4">
                                <label class="flex items-start cursor-pointer">
                                    <input type="radio" name="migrationOption" value="migrate" checked class="mt-1 mr-3">
                                    <div>
                                        <p class="font-semibold text-gray-800">localStorageã®ãƒ‡ãƒ¼ã‚¿ã‚’Firestoreã«ç§»è¡Œã™ã‚‹ï¼ˆæ¨å¥¨ï¼‰</p>
                                        <p class="text-sm text-gray-600 mt-1">æ—¢å­˜ã®ç”Ÿå¾’ãƒ‡ãƒ¼ã‚¿ãƒ»ç›¸è«‡è¨˜éŒ²ã‚’ã™ã¹ã¦Firestoreã«ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚localStorageã®ãƒ‡ãƒ¼ã‚¿ã¯æ®‹ã‚Šã¾ã™ã€‚</p>
                                    </div>
                                </label>
                            </div>

                            <div class="bg-white border-2 border-gray-300 rounded-lg p-4">
                                <label class="flex items-start cursor-pointer">
                                    <input type="radio" name="migrationOption" value="fresh" class="mt-1 mr-3">
                                    <div>
                                        <p class="font-semibold text-gray-800">æ–°è¦ã«Firestoreã§é–‹å§‹ã™ã‚‹</p>
                                        <p class="text-sm text-gray-600 mt-1">æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã¯ç§»è¡Œã›ãšã€Firestoreã‚’ç©ºã®çŠ¶æ…‹ã‹ã‚‰ä½¿ã„å§‹ã‚ã¾ã™ã€‚</p>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <div class="mt-6">
                            <button onclick="executeMigration()" 
                                    class="w-full bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition text-lg font-semibold">
                                <i class="fas fa-rocket mr-2"></i>Firebaseæ¥ç¶šã‚’æœ‰åŠ¹åŒ–
                            </button>
                        </div>

                        <div id="migrationProgress" class="mt-4 hidden">
                            <div class="bg-gray-200 rounded-full h-4 overflow-hidden">
                                <div id="migrationProgressBar" class="bg-blue-600 h-full transition-all duration-300" style="width: 0%"></div>
                            </div>
                            <p id="migrationStatus" class="text-center mt-2 text-gray-700"></p>
                        </div>

                        <div id="migrationResult" class="mt-4 hidden"></div>
                    </div>

                    <div class="bg-green-50 border-l-4 border-green-500 p-4 hidden" id="completionMessage">
                        <p class="font-semibold text-green-800">ğŸ‰ è¨­å®šå®Œäº†ï¼</p>
                        <p class="text-green-700 mt-2">Firebaseãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒæœ‰åŠ¹ã«ãªã‚Šã¾ã—ãŸã€‚ã“ã‚Œã§150-200å°ã®PCã‹ã‚‰åŒæ™‚ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚</p>
                        <ul class="list-disc ml-6 mt-3 text-green-700 space-y-1">
                            <li>ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã¯Firestoreã«ä¿å­˜ã•ã‚Œã¾ã™</li>
                            <li>è¤‡æ•°ã®PCã§åŒã˜ãƒ‡ãƒ¼ã‚¿ã‚’å…±æœ‰ã§ãã¾ã™</li>
                            <li>ãƒ‡ãƒ¼ã‚¿ã¯ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§åŒæœŸã•ã‚Œã¾ã™</li>
                        </ul>
                    </div>

                    <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4">
                        <p class="font-semibold text-yellow-800">ğŸ’¡ é‡è¦ãªæƒ…å ±</p>
                        <ul class="list-disc ml-6 mt-2 text-yellow-700 space-y-1">
                            <li><strong>ç„¡æ–™æ åˆ¶é™:</strong> èª­ã¿å–ã‚Š50,000å›/æ—¥ã€æ›¸ãè¾¼ã¿20,000å›/æ—¥</li>
                            <li><strong>é€šå¸¸ä½¿ç”¨:</strong> 200åã®ç”Ÿå¾’ã§1æ—¥ã‚ãŸã‚Šç´„1,000-2,000å›ã®ã‚¢ã‚¯ã‚»ã‚¹</li>
                            <li><strong>ç„¡æ–™æ ã§ååˆ†ä½¿ãˆã¾ã™</strong></li>
                            <li>Firebase Consoleã§ä½¿ç”¨çŠ¶æ³ã‚’ç¢ºèªã§ãã¾ã™</li>
                        </ul>
                    </div>
                </div>

                <div class="mt-6 flex justify-between">
                    <button onclick="prevStep(4)" class="bg-gray-500 text-white px-8 py-3 rounded-lg hover:bg-gray-600 transition">
                        <i class="fas fa-arrow-left mr-2"></i>å‰ã¸æˆ»ã‚‹
                    </button>
                    <a href="teacher.html" id="completeBtn" class="bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 transition hidden">
                        <i class="fas fa-check mr-2"></i>æ•™å“¡ç”»é¢ã«æˆ»ã‚‹
                    </a>
                </div>
            </div>
        </div>
    </div>

    <style>
        .step-indicator {
            transition: all 0.3s ease;
        }
        .step-circle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #e5e7eb;
            color: #9ca3af;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            font-weight: bold;
            font-size: 1.25rem;
            transition: all 0.3s ease;
        }
        .step-indicator.active .step-circle {
            background-color: #2563eb;
            color: white;
        }
        .step-indicator.active p {
            color: #2563eb;
            font-weight: 600;
        }
        .step-indicator.completed .step-circle {
            background-color: #10b981;
            color: white;
        }
    </style>

    <script>
        let currentStep = 1;
        let firebaseConfig = null;

        // ã‚¹ãƒ†ãƒƒãƒ—åˆ‡ã‚Šæ›¿ãˆ
        function nextStep(step) {
            document.getElementById(`step${currentStep}`).classList.add('hidden');
            document.querySelector(`[data-step="${currentStep}"]`).classList.remove('active');
            document.querySelector(`[data-step="${currentStep}"]`).classList.add('completed');
            
            currentStep = step;
            document.getElementById(`step${step}`).classList.remove('hidden');
            document.querySelector(`[data-step="${step}"]`).classList.add('active');
            
            window.scrollTo({ top: 0, behavior: 'smooth' });

            if (step === 5) {
                checkCurrentData();
            }
        }

        function prevStep(step) {
            document.getElementById(`step${currentStep}`).classList.add('hidden');
            document.querySelector(`[data-step="${currentStep}"]`).classList.remove('active');
            
            currentStep = step;
            document.getElementById(`step${step}`).classList.remove('hidden');
            document.querySelector(`[data-step="${step}"]`).classList.add('active');
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // æ¥ç¶šãƒ†ã‚¹ãƒˆ
        async function testConnection() {
            const resultDiv = document.getElementById('connectionResult');
            resultDiv.classList.remove('hidden');
            resultDiv.innerHTML = '<p class="text-gray-600"><i class="fas fa-spinner fa-spin mr-2"></i>æ¥ç¶šãƒ†ã‚¹ãƒˆä¸­...</p>';

            try {
                // è¨­å®šå€¤ã‚’å–å¾—
                firebaseConfig = {
                    apiKey: document.getElementById('apiKey').value.trim(),
                    authDomain: document.getElementById('authDomain').value.trim(),
                    projectId: document.getElementById('projectId').value.trim(),
                    storageBucket: document.getElementById('storageBucket').value.trim(),
                    messagingSenderId: document.getElementById('messagingSenderId').value.trim(),
                    appId: document.getElementById('appId').value.trim()
                };

                // å…¥åŠ›ãƒã‚§ãƒƒã‚¯
                const emptyFields = Object.entries(firebaseConfig).filter(([key, value]) => !value);
                if (emptyFields.length > 0) {
                    throw new Error('ã™ã¹ã¦ã®é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                }

                // FirebaseåˆæœŸåŒ–
                await window.firebaseAdapter.initialize(firebaseConfig);

                // æ¥ç¶šãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
                const testResult = await window.firebaseAdapter.testConnection();

                if (testResult.success) {
                    resultDiv.innerHTML = `
                        <div class="bg-green-50 border-l-4 border-green-500 p-4">
                            <p class="font-semibold text-green-800">âœ… æ¥ç¶šæˆåŠŸï¼</p>
                            <p class="text-green-700 mt-1">${testResult.message}</p>
                        </div>
                    `;
                    
                    // è¨­å®šã‚’ä¿å­˜
                    localStorage.setItem('firebase_config', JSON.stringify(firebaseConfig));
                    
                    // æ¬¡ã¸ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
                    const nextBtn = document.getElementById('step4NextBtn');
                    nextBtn.disabled = false;
                    nextBtn.classList.remove('bg-gray-400', 'cursor-not-allowed');
                    nextBtn.classList.add('bg-blue-600', 'hover:bg-blue-700', 'cursor-pointer');
                } else {
                    throw new Error(testResult.message);
                }

            } catch (error) {
                console.error('æ¥ç¶šãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                resultDiv.innerHTML = `
                    <div class="bg-red-50 border-l-4 border-red-500 p-4">
                        <p class="font-semibold text-red-800">âŒ æ¥ç¶šå¤±æ•—</p>
                        <p class="text-red-700 mt-1">${error.message}</p>
                        <p class="text-sm text-red-600 mt-2">è¨­å®šå†…å®¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</p>
                    </div>
                `;
            }
        }

        // ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ç¢ºèª
        function checkCurrentData() {
            const students = JSON.parse(localStorage.getItem('table_students') || '[]');
            const consultations = JSON.parse(localStorage.getItem('table_consultations') || '[]');
            const surveys = JSON.parse(localStorage.getItem('table_surveys') || '[]');

            const infoDiv = document.getElementById('currentDataInfo');
            infoDiv.innerHTML = `
                <ul class="space-y-1">
                    <li><strong>ç”Ÿå¾’ãƒ‡ãƒ¼ã‚¿:</strong> ${students.length}ä»¶</li>
                    <li><strong>ç›¸è«‡è¨˜éŒ²:</strong> ${consultations.length}ä»¶</li>
                    <li><strong>ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ:</strong> ${surveys.length}ä»¶</li>
                </ul>
            `;
        }

        // ãƒ‡ãƒ¼ã‚¿ç§»è¡Œå®Ÿè¡Œ
        async function executeMigration() {
            const option = document.querySelector('input[name="migrationOption"]:checked').value;
            const progressDiv = document.getElementById('migrationProgress');
            const resultDiv = document.getElementById('migrationResult');
            const completionDiv = document.getElementById('completionMessage');
            
            progressDiv.classList.remove('hidden');
            resultDiv.classList.add('hidden');
            resultDiv.innerHTML = '';

            try {
                // FirebaseåˆæœŸåŒ–ï¼ˆå¿µã®ãŸã‚ï¼‰
                if (!window.firebaseAdapter.initialized) {
                    const config = JSON.parse(localStorage.getItem('firebase_config'));
                    await window.firebaseAdapter.initialize(config);
                }

                if (option === 'migrate') {
                    // ãƒ‡ãƒ¼ã‚¿ç§»è¡Œå®Ÿè¡Œ
                    updateProgress(20, 'ãƒ‡ãƒ¼ã‚¿ç§»è¡Œã‚’é–‹å§‹ã—ã¦ã„ã¾ã™...');
                    
                    const migrationResult = await window.firebaseAdapter.migrateFromLocalStorage();
                    
                    updateProgress(80, 'ãƒ‡ãƒ¼ã‚¿ç§»è¡ŒãŒå®Œäº†ã—ã¾ã—ãŸ');

                    if (migrationResult.success) {
                        resultDiv.innerHTML = `
                            <div class="bg-green-50 border-l-4 border-green-500 p-4">
                                <p class="font-semibold text-green-800">âœ… ç§»è¡ŒæˆåŠŸï¼</p>
                                <p class="text-green-700 mt-1">${migrationResult.message}</p>
                                <div class="mt-2 text-sm text-green-700">
                                    <p><strong>ç§»è¡Œè©³ç´°:</strong></p>
                                    <ul class="list-disc ml-6">
                                        <li>ç”Ÿå¾’ãƒ‡ãƒ¼ã‚¿: ${migrationResult.details.students}ä»¶</li>
                                        <li>ç›¸è«‡è¨˜éŒ²: ${migrationResult.details.consultations}ä»¶</li>
                                        <li>ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ: ${migrationResult.details.surveys}ä»¶</li>
                                    </ul>
                                </div>
                            </div>
                        `;
                    } else {
                        throw new Error(migrationResult.message);
                    }
                } else {
                    updateProgress(50, 'æ–°è¦è¨­å®šã‚’æº–å‚™ä¸­...');
                }

                // Firebaseä½¿ç”¨ãƒ•ãƒ©ã‚°ã‚’æœ‰åŠ¹åŒ–
                updateProgress(90, 'è¨­å®šã‚’ä¿å­˜ä¸­...');
                localStorage.setItem('use_firebase', 'true');
                
                updateProgress(100, 'å®Œäº†ï¼');
                resultDiv.classList.remove('hidden');
                completionDiv.classList.remove('hidden');
                document.getElementById('completeBtn').classList.remove('hidden');

            } catch (error) {
                console.error('ç§»è¡Œã‚¨ãƒ©ãƒ¼:', error);
                progressDiv.classList.add('hidden');
                resultDiv.classList.remove('hidden');
                resultDiv.innerHTML = `
                    <div class="bg-red-50 border-l-4 border-red-500 p-4">
                        <p class="font-semibold text-red-800">âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</p>
                        <p class="text-red-700 mt-1">${error.message}</p>
                    </div>
                `;
            }
        }

        function updateProgress(percent, message) {
            document.getElementById('migrationProgressBar').style.width = percent + '%';
            document.getElementById('migrationStatus').textContent = message;
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®å‡¦ç†
        window.addEventListener('DOMContentLoaded', function() {
            // æ—¢å­˜ã®è¨­å®šã‚’èª­ã¿è¾¼ã¿
            const savedConfig = localStorage.getItem('firebase_config');
            if (savedConfig) {
                try {
                    const config = JSON.parse(savedConfig);
                    document.getElementById('apiKey').value = config.apiKey || '';
                    document.getElementById('authDomain').value = config.authDomain || '';
                    document.getElementById('projectId').value = config.projectId || '';
                    document.getElementById('storageBucket').value = config.storageBucket || '';
                    document.getElementById('messagingSenderId').value = config.messagingSenderId || '';
                    document.getElementById('appId').value = config.appId || '';
                } catch (e) {
                    console.error('è¨­å®šã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', e);
                }
            }
        });
    </script>
</body>
</html>
